---
title: Microsoft 365 Mail
description: Manage Outlook emails with full inbox control, attachment handling, and shared mailbox support
icon: "server"
---

## Overview

The Microsoft 365 Mail server enables AI assistants to interact with [Microsoft Outlook](https://www.microsoft.com/microsoft-365/outlook/email-and-calendar-software-microsoft-outlook) and Exchange Online, providing comprehensive email management, attachment handling, and shared mailbox capabilities through Microsoft Graph API.

## How to Add Microsoft 365 Mail

The setup process varies depending on your Microsoft account type:

### Personal Outlook Users

If you have a free outlook.com email address:

<Steps>
  <Step title="Add Server">
    Add the Microsoft 365 Mail server to your Nexus environment through the server directory.
  </Step>
  <Step title="Authorize">
    Simply log in and approve the OAuth consent request. No additional steps needed.
  </Step>
  <Step title="Test Connection">
    Try "Show me my latest 5 emails" to verify the connection works.
  </Step>
</Steps>

### Microsoft 365 Business Users

For Microsoft 365 Business or Office 365 license holders, **admin approval is required** for first-time setup:

<Steps>
  <Step title="Initial Authorization Attempt">
    Add the Microsoft 365 Mail server and attempt to authorize. Non-admin users will see a "Need admin approval" dialog indicating that Civic Nexus needs permission to access resources in your organization that only an admin can grant.
  </Step>
  <Step title="Admin Grants Consent (One-Time)">
    Your Microsoft tenant administrator must configure consent in Microsoft Entra ID:

    **Access Entra ID:**
    - From Microsoft 365: Click the app launcher (grid icon) in the top-left corner of any Microsoft 365 app → Click **Admin** → From the left sidebar, click **Show All** → Under "Admin centers", select **Identity**
    - From Azure Portal: Click the app launcher (grid icon) in the top-left corner → Select **Entra** from the Microsoft Cloud services

    **Configure User Consent:**
    1. In Entra ID, select **Enterprise apps** from the left sidebar
    2. Under the "Security" section, click **Consent and permissions**
    3. Click **User consent settings**
    4. Select "Allow user consent for apps from verified publishers, for selected permissions" (This allows users to trigger authorization requests from Nexus, since Civic is a verified publisher)
    5. Click **Save** (Important: Save before proceeding to the next step)
    6. Click "Select permissions to classify as low impact" (This whitelists the specific permissions users are allowed to consent to. If prompted to save, click **Save** before moving on)
    7. On the permissions screen, click **Add permissions** → Select **Microsoft Graph**
    8. Select all **OpenId permissions** (required): `openid`, `profile`, `email`
    9. Add the base permissions: `offline_access`, `User.Read`
    10. Add Mail-specific permissions: `Mail.Read`, `Mail.ReadWrite`, `Mail.Send`
    11. Click **Add permissions** then **Save**
  </Step>
  <Step title="Wait and Retry">
    Wait up to **1 hour** for changes to propagate, then retry authorization in Nexus.
  </Step>
  <Step title="Complete Authorization">
    You'll now see a standard OAuth consent screen showing "Permissions requested" by Civic Nexus. The app will request permissions such as:
    - Maintain access to data you have given it access to
    - Read and write access to user mail
    - Send mail as a user
    - View your basic profile

    Click **Accept** to complete the authorization and start using the Microsoft 365 Mail integration.
  </Step>
</Steps>

<Note>
**Alternative Setup Method:** The steps above use a proactive approach where admins configure permissions up-front. Alternatively, administrators can enable "Admin consent requests" (found in **Admin consent settings** within Entra ID). This allows users to trigger approval requests directly when they attempt to authorize, and admins can approve on-demand rather than pre-configuring permissions.

For complete setup instructions with screenshots and troubleshooting, see the [detailed MS365 integration guide](https://civicteam.atlassian.net/wiki/spaces/Labs/pages/3793944577).
</Note>

## What You Can Do

<CardGroup cols={2}>
  <Card title="Email Management" icon="envelope">
    Read, send, and organize emails with full inbox control
  </Card>
  <Card title="Attachment Handling" icon="paperclip">
    Upload, download, and manage email attachments programmatically
  </Card>
  <Card title="Folder Organization" icon="folder">
    Create, browse, and manage email folders for better organization
  </Card>
  <Card title="Shared Mailboxes" icon="users">
    Access and manage shared mailboxes for team collaboration
  </Card>
</CardGroup>

## Available Tools

### Email Operations

<AccordionGroup>
  <Accordion title="list_messages">
    List emails with filtering by folder, read status, and date range
  </Accordion>

  <Accordion title="get_message">
    Retrieve full email content including body and metadata
  </Accordion>

  <Accordion title="send_message">
    Send emails with HTML or plain text formatting
  </Accordion>

  <Accordion title="create_draft">
    Create draft emails for review before sending
  </Accordion>

  <Accordion title="delete_message">
    Delete emails from inbox or specific folders
  </Accordion>
</AccordionGroup>

### Attachment Management

<AccordionGroup>
  <Accordion title="list_attachments">
    List all attachments in a specific email
  </Accordion>

  <Accordion title="get_attachment">
    Download and retrieve attachment content
  </Accordion>

  <Accordion title="add_attachment">
    Attach files to emails when sending
  </Accordion>
</AccordionGroup>

### Folder Management

<AccordionGroup>
  <Accordion title="list_folders">
    List all mail folders in your mailbox
  </Accordion>

  <Accordion title="create_folder">
    Create new folders for email organization
  </Accordion>

  <Accordion title="move_message">
    Move emails between folders
  </Accordion>
</AccordionGroup>

### Shared Mailboxes

<AccordionGroup>
  <Accordion title="access_shared_mailbox">
    Access shared mailboxes with delegated permissions
  </Accordion>

  <Accordion title="send_from_shared">
    Send emails from shared mailbox addresses
  </Accordion>
</AccordionGroup>

## Use Cases

### Reading Mail
"Show me my latest 5 emails" - Quickly review recent messages.

### Filtered Search
"List all unread emails from the last week" - Find specific messages with criteria.

### Attachment Management
"Show me all emails with attachments" - Locate emails with files.

### Sending Mail
"Send an email to john@example.com with subject 'Meeting Follow-up' and a brief summary of our discussion" - Compose and send emails directly.

### Draft Creation
"Create a draft email to sarah@example.com about the Q4 planning session" - Prepare emails for review.

### Folder Organization
"Move this email to my Archive folder" - Organize inbox programmatically.

### Shared Mailbox Access
"Show me emails in the support@company.com shared mailbox" - Access team mailboxes.

### Attachment Analysis
"Download the PDF from the latest email and summarize its contents" - Extract and analyze file contents.

<Note>
**Attachment size limit:** Attachments are limited by Microsoft Graph API restrictions (typically 4MB for single request).

**Search limitations:** Cannot combine search ($search) with filter ($filter) parameters in the same query.

**HTML and plain text:** Supports both HTML and plain text email formats.
</Note>
