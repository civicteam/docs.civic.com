---
title: "Embedded Wallets"
icon: "wallet"
public: true
description: "Civic Auth apps can provide their users with access to Web3 without any prior knowledge"
---

The **Civic Auth Web3 SDK** ( [@civic/auth-web3](https://www.npmjs.com/package/@civic/auth-web3) ) extends the functionality of the base **Civic Auth SDK** by including the ability to provision a Web3 wallet for users. This allows Civic Auth apps to provide their users with access to the world of Cryptocurrencies and Web3 without any hassle or prior knowledge.

<Info>
  **Supported Networks**: Civic embedded wallets support 18+ EVM-compatible chains including Ethereum, Base, Polygon, BSC, Arbitrum One, Avalanche, and many more. See the [complete list](/web3/ethereum-evm#supported-evm-chains) for all supported networks.
</Info>

<Info>
  Currently, we don't support connecting users' existing self-custodial wallets. This is coming soon.

  Right now, we only support embedded wallets, which are generated on behalf of the user by our non-custodial wallet partner. Neither Civic nor your app ever has access to the wallets' private keys.
</Info>

## Quick Start

Sign up for Civic Auth at [auth.civic.com](https://auth.civic.com) and make sure to select the "Web3 wallet" option.

<Check>
  If you already have an account, just log in and select the Web3 wallet option in the configuration to enable Web3 wallets.
</Check>

<Check>
  **Code Examples**

  Some complete examples for Solana and EVM can be found on Github [here](https://github.com/civicteam/civic-auth-examples/tree/main/packages/civic-auth-web3).

  The Ethereum and Solana pages have links to specific examples.

  Also see the code examples in this documentation.
</Check>

## Installation

Install the Civic Auth Web3 SDK:

<CodeGroup>

```npm npm
npm install @civic/auth-web3
```


```yarn yarn
yarn add @civic/auth-web3
```


```pnpm pnpm
pnpm install @civic/auth-web3
```


```bun bun
bun add @civic/auth-web3
```

</CodeGroup>

## Integration

Choose your framework for instructions on how to integrate Civic Auth Web3 into your application.

<Info>
  NOTE - Web3 wallets are available for React and Next.js environments.

  If you are interested in using Civic's Web3 wallet feature in other environments, please contact us in [our developer community](https://join.slack.com/t/civic-developers/shared_invite/zt-37tv9fyo7-aDT43mUjOFQwdQFmfZLTRw).
</Info>

<CardGroup cols={3}>
  <Card title="React" href="/integration/react" img="/images/auth/web3/react.png">
    
  </Card>
  <Card title="Next.js" href="/integration/nextjs" img="/images/auth/web3/next.png">
    
  </Card>
</CardGroup>

## Using the Wallet

Follow these guides to set up Web3 wallets for your users:

<CardGroup cols={2}>
  <Card title="Ethereum & EVMs" icon="diamond" horizontal href="/web3/ethereum-evm">
    Supports 18+ EVM chains including Ethereum, Base, Polygon, Arbitrum, and more
  </Card>
  <Card title="Solana" icon="code" horizontal href="/web3/solana">
    
  </Card>
</CardGroup>

## Server-Side Integration

For server-side frameworks such as ExpressJS, use `@civic/auth-web3` to access embedded wallet addresses after authentication.

Full working example: [express-with-wallet](https://github.com/civicteam/civic-auth-examples/tree/main/packages/civic-auth/server/express-with-wallet)

### Installation

```bash
npm install @civic/auth-web3
```

### Setup

Configure `CivicAuth` with cookie-based storage per request, and attach it to each Express request via middleware:

```typescript
import express, { Request, Response, NextFunction } from "express";
import cookieParser from "cookie-parser";
import { CookieStorage, CivicAuth } from "@civic/auth-web3/server";

const app = express();
app.use(cookieParser());

const config = {
  clientId: process.env.CLIENT_ID!,
  redirectUrl: "http://localhost:3001/auth/callback",
  postLogoutRedirectUrl: "http://localhost:3001/",
};

class ExpressCookieStorage extends CookieStorage {
  constructor(private req: Request, private res: Response) {
    super({ secure: process.env.NODE_ENV === "production" });
  }

  async get(key: string): Promise<string | null> {
    return this.req.cookies[key];
  }

  async set(key: string, value: string): Promise<void> {
    this.res.cookie(key, value, this.settings);
  }

  async clear(): Promise<void> {
    for (const key in this.req.cookies) {
      this.res.clearCookie(key);
    }
  }

  async delete(key: string): Promise<void> {
    this.res.clearCookie(key);
  }
}

app.use((req: Request, res: Response, next: NextFunction) => {
  req.storage = new ExpressCookieStorage(req, res);
  req.civicAuth = new CivicAuth(req.storage, config);
  next();
});
```

### Authentication Flow

```typescript
app.get("/", async (req: Request, res: Response) => {
  const url = await req.civicAuth.buildLoginUrl();
  res.redirect(url.toString());
});

app.get("/auth/callback", async (req: Request, res: Response) => {
  const { code, state } = req.query as { code: string; state: string };
  await req.civicAuth.resolveOAuthAccessCode(code, state);
  res.redirect("/admin/dashboard");
});
```

### Retrieving the Wallet Address

Once the user is authenticated, use `getWallets()` from `@civic/auth-web3/server` to retrieve the user's embedded wallet address(es):

```typescript
import { getWallets } from "@civic/auth-web3/server";

app.get("/admin/dashboard", async (req: Request, res: Response) => {
  const user = await req.civicAuth.getUser();
  const tokens = await req.civicAuth.getTokens();

  if (!user) return res.status(401).send("Unauthorized");

  const userDetails = {
    ...user,
    idToken: tokens?.idToken || "",
  };

  const wallets = await getWallets(userDetails);

  res.json({
    user: user.name,
    walletAddresses: wallets.map((wallet) => wallet.walletAddress),
  });
});
```

`getWallets()` returns an array of wallet objects, each with a `walletAddress` property.

<Warning>
  Do not decode the ID token JWT to retrieve the wallet address, and there is no `user.wallet` property â€” always use `getWallets()` from `@civic/auth-web3/server`.
</Warning>

### Auth Middleware

```typescript
const authMiddleware = async (req: Request, res: Response, next: NextFunction) => {
  if (!req.civicAuth.isLoggedIn()) return res.status(401).send("Unauthorized");
  next();
};

app.use("/admin", authMiddleware);
```

### TypeScript: Extending the Request Type

```typescript
declare global {
  namespace Express {
    interface Request {
      storage: ExpressCookieStorage;
      civicAuth: CivicAuth;
    }
  }
}
```

## About Embedded Wallets

### What are Embedded Wallets?

Embedded wallets are cryptocurrency wallets provided directly by an app or website, rather than requiring the user to supply their own.

This approach is a powerful tool for onboarding non-crypto users into Web3, enabling apps to cater to both crypto-native users and newcomers alike.

By removing the need for complicated wallet setup, remembering seed phrases etc., embedded wallets are a vital tool for bridging the gap between Web2 and Web3.

### Civic's Embedded Wallets

The Civic Embedded Wallet Service is non-custodial, meaning neither Civic nor Civic's customers have control over users' wallets or assets.

Each wallet is linked to a user's SSO (Single Sign-On) provider, such as Google, ensuring that only authenticated users can sign transactions.

Civic's wallets are EOA (Externally Owned Account) wallets, rather than smart contract (AKA account abstraction) wallets. This has benefits in terms of simplicity and lower gas costs. However, they can be upgraded to support account abstraction, for example to support gas sponsorship. Contact us in [our developer community](https://join.slack.com/t/civic-developers/shared_invite/zt-37tv9fyo7-aDT43mUjOFQwdQFmfZLTRw) if you're interested in this feature.

### **Recovery**

Our wallet provider includes a recovery feature, ensuring that funds are not lost in case of a service interruption with Civic.

For more details on the security and recovery features of Civic wallets, please refer to the documentation provided by our service provider.
